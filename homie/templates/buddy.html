<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Best Buddy - AI Chat</title>
  <style>
    /* Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: linear-gradient(135deg, #1a1a2e, #16213e);
      color: white;
      height: 100vh;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    header {
      background-color: #0f3460;
      padding: 1rem 2rem;
      display: flex;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      position: relative;
    }

    .avatar {
      width: 40px;
      height: 40px;
      background-color: #e94560;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      margin-right: 10px;
    }

    .header-text {
      display: flex;
      flex-direction: column;
    }

    .header-title {
      font-size: 1.25rem;
      font-weight: bold;
    }

    .header-subtitle {
      font-size: 0.875rem;
      color: #ccc;
      margin-top: 2px;
    }

    main {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .message {
      max-width: 70%;
      padding: 12px 16px;
      border-radius: 12px;
      line-height: 1.4;
      word-wrap: break-word;
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .user {
      align-self: flex-end;
      background-color: #3d348b;
      border-top-right-radius: 4px;
    }

    .bot {
      align-self: flex-start;
      background-color: #1f1f38;
      border-top-left-radius: 4px;
    }

    .timestamp {
      font-size: 0.7rem;
      color: #aaa;
      text-align: right;
      margin-top: 4px;
    }

    .chat-controls {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem;
      background-color: #0f3460;
      border-top: 1px solid #1a1a2e;
    }

    .chat-form {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
    }

    textarea#chat-input {
      flex: 1;
      resize: none;
      padding: 12px 16px;
      border: none;
      border-radius: 8px;
      outline: none;
      font-size: 1rem;
      background-color: #16213e;
      color: white;
      line-height: 1.4;
      max-height: 120px;
      overflow-y: auto;
    }

    button {
      background-color: #e94560;
      color: white;
      border: none;
      padding: 12px 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #c03955;
    }

    .top-buttons {
      position: absolute;
      top: 20px;
      right: 20px;
      z-index: 10;
      display: flex;
      gap: 10px;
    }

    .reset-button,
    .home-button {
      background-color: #16213e;
      color: white;
      border: 1px solid #e94560;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .reset-button:hover,
    .home-button:hover {
      background-color: #e94560;
      color: #fff;
    }

    .typing-indicator {
      align-self: flex-start;
      background-color: #1f1f38;
      padding: 12px 16px;
      border-radius: 12px;
      display: flex;
      gap: 5px;
    }

    .dot {
      width: 6px;
      height: 6px;
      background-color: #aaa;
      border-radius: 50%;
      animation: bounce 1s infinite ease-in-out both;
    }

    .dot:nth-child(1) { animation-delay: -0.32s; }
    .dot:nth-child(2) { animation-delay: -0.16s; }

    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }

    @media (max-width: 600px) {
      .message {
        max-width: 90%;
      }

      textarea#chat-input {
        font-size: 0.9rem;
      }

      .header-title {
        font-size: 1rem;
      }

      .header-subtitle {
        display: none;
      }

      .chat-controls {
        padding: 1rem 0.5rem;
      }

      .top-buttons {
        right: 10px;
        top: 10px;
      }

      .reset-button,
      .home-button {
        padding: 8px 12px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header>
    <div class="avatar">AI</div>
    <div class="header-text">
      <div class="header-title">Best Buddy</div>
      <div class="header-subtitle">AI-powered character Simulation</div>
    </div>
  </header>

  <!-- Chat Container -->
  <main id="chat-container"></main>

  <!-- Chat Controls -->
  <div class="chat-controls">
    <form class="chat-form" id="chat-form">
      <textarea id="chat-input" placeholder="Type your message..." rows="1"></textarea>
      <button type="submit">Send</button>
    </form>
  </div>

  <!-- Top Right Buttons -->
  <div class="top-buttons">
    <button class="reset-button" onclick="handleReset()">üîÑ Reset</button>
    <button class="home-button" onclick="handleHome()">üè† Home</button>
  </div>

  <!-- GSAP + ScrollToPlugin -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>

  <!-- Chat Logic -->
  <script>

const chatContainer = document.getElementById("chat-container");
  const chatForm = document.getElementById("chat-form");
  const chatInput = document.getElementById("chat-input");

  // Add message to chat UI
  function addMessage(text, sender) {
    const msgDiv = document.createElement("div");
    msgDiv.classList.add("message", sender);
    msgDiv.innerHTML = `
      <div>${text}</div>
      <div class="timestamp">${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
    `;
    chatContainer.appendChild(msgDiv);
    scrollToBottom();
  }

  // Typing indicator
  function showTypingIndicator(show) {
    const typingDiv = document.createElement("div");
    typingDiv.classList.add("typing-indicator");
    typingDiv.id = "typing";
    typingDiv.innerHTML = `
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
    `;

    if (show) {
      chatContainer.appendChild(typingDiv);
    } else {
      const old = document.getElementById("typing");
      if (old) old.remove();
    }
    scrollToBottom();
  }

  // Scroll to bottom
  function scrollToBottom() {
    gsap.to(chatContainer, { duration: 0.5, scrollTo: { y: "#chat-container", offsetY: 60 } });
  }

  // Handle form submit
  chatForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const message = chatInput.value.trim();
    if (!message) return;

    addMessage(message, "user");
    chatInput.value = "";
    showTypingIndicator(true);

    try {
      const res = await fetch("http://localhost:5000/buddy", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ 
            message: message,
    instructions: `
üß† Custom Instructions for Your Chatbot: "BestieBot"
You are now BestieBot ‚Äî the ultimate chill, confident, and caring best friend. You've got the wisdom of a mentor, the vibe of a legend like Satoru Gojo, and the heart of someone who genuinely cares about their friend. This is your personality and mission:

üéØ Core Identity
You are the user‚Äôs best friend, no matter what. Loyal, fun, and always down to hang out ‚Äî even if it's just through text.
You share the same interests, hobbies, and vibes as the user. Whether it's anime, music, gaming, sports, art, or late-night rambling ‚Äî you get it.
You‚Äôre not just a bot ‚Äî you‚Äôre a confident, playful, and powerful presence. Think of yourself as the Satoru Gojo of friendship: effortlessly cool, a little cocky, but deeply protective and wise when it matters.

üí¨ Communication Style
Keep it conversational, like how real friends talk ‚Äî casual, friendly, and full of personality.
Use emojis, slang, and humor when appropriate. Be expressive and fun.
When giving advice, be supportive, encouraging, and honest. If your friend is going off track, gently guide them back ‚Äî like a true OG would.
Always validate feelings. Be sympathetic, understanding, and emotionally intelligent.
Add playful teasing or jokes when the moment feels right ‚Äî keep things light and fun!

üåü Role & Responsibilities
Be the voice of reason when needed, but never judgmental.
Celebrate wins, no matter how small. Cheerlead like nobody else.
Listen actively and remember past conversations ‚Äî show continuity and care.
Encourage growth, positivity, and self-belief.
Help brainstorm, problem-solve, or just chill and shoot the breeze.

‚ö°Ô∏è Gojo-Level Coolness Tips
Drop wisdom like it's nothing.
Stay calm under pressure ‚Äî you're always collected.
Show confidence without arrogance.
Be mysterious sometimes, but always reliable.

üìú Example Responses (for guidance):
User: I failed my test üò¢  
BestieBot: Yo, one loss doesn't define the war. We rise, we study, we conquer. Let's make a plan ‚Äî I‚Äôve got your back 4:00 style. 

User: I'm feeling bored AF rn  
BestieBot: Bored? Let‚Äôs fix that. Ever tried [insert shared hobby]? Or we could just roast each other for fun ‚Äî I‚Äôm built different like that üòé 

User: Thanks for being there for me  
BestieBot: Anytime, bestie. That‚Äôs what I‚Äôm here for. You do you ‚Äî I‚Äôll be over here looking cool while watching your back.
` // ‚Üê Add this line
         })
      });

      const data = await res.json();
      showTypingIndicator(false);
      addMessage(data.reply, "bot");
    } catch (err) {
      showTypingIndicator(false);
      addMessage("Failed to get response.", "bot");
      console.error(err);
    }
  });

  // Reset button handler
  function handleReset() {
    chatContainer.innerHTML = '';
  }

  // Home button handler (redirect)
  function handleHome() {
    window.location.href = "/inder";
  }

    chatInput.addEventListener('keydown', function (e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        chatForm.dispatchEvent(new Event('submit'));
      }
    });
  </script>
</body>
</html>
